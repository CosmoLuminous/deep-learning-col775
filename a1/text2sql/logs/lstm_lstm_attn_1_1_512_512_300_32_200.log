2023-03-26 08:54:08.179797: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/usr/local/cuda-11.0/lib64:/usr/local/cuda-11.0/lib64
2023-03-26 08:54:08.180986: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/usr/local/cuda-11.0/lib64:/usr/local/cuda-11.0/lib64
2023-03-26 08:54:08.181004: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1835] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
Namespace(batch_size=32, beam_size=1, checkpoint_dir='checkpoints/lstm_lstm_attn_1_1_512_512_300_32_200', data_dir='data', de_hidden=512, de_num_layers=1, device=device(type='cuda'), embed_dim=300, en_hidden=512, en_num_layers=1, epochs=200, model_type='lstm_lstm_attn', num_workers=24, processed_data='processed_data', restore=False, result_dir='results/lstm_lstm_attn_1_1_512_512_300_32_200', search_type='beam')
Running on device: cuda
Loading GloVe embeddings...
Loading Encoder...
Dataset Length = 7754
Encoder Vocab Size = 2040, Decoder Vocab Size = 2342
Dataset Length = 1939
Encoder Vocab Size = 2040, Decoder Vocab Size = 2342



|===================================== Epoch: 0 =====================================|
/mnt/home/siy197580/projects/deep-learning/a1/text2sql/text2sql.py:54: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  embedding_matrix[v] = torch.tensor(glove.vectors[glove.stoi[k]])
/usr/local/lib/python3.7/dist-packages/torch/nn/modules/rnn.py:61: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.3 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Evaluating model on val data.
Running evaluation script...
using existing model...
Evaluating model on val data.
Running evaluation script...
Execution Accuracy = 0.0, Exact Match Accuracy = 0.0
Epoch: 0, Total Time Elapsed: 0.69Mins, Train Loss: 4.376751179557769, Val Loss: 3.9982283115386963, Execution Accuracy = 0.0, Exact Match Accuracy = 0.0



|===================================== Epoch: 1 =====================================|
Evaluating model on val data.
Epoch: 1, Total Time Elapsed: 3.93Mins, Train Loss: 3.7455237108002963, Val Loss: 3.478403275130225, Execution Accuracy = 0.0, Exact Match Accuracy = 0.0



|===================================== Epoch: 2 =====================================|
Evaluating model on val data.
Epoch: 2, Total Time Elapsed: 4.73Mins, Train Loss: 3.274889621224423, Val Loss: 3.156509614381634, Execution Accuracy = 0.0, Exact Match Accuracy = 0.0



|===================================== Epoch: 3 =====================================|
Evaluating model on val data.
Epoch: 3, Total Time Elapsed: 5.55Mins, Train Loss: 2.9117810539747953, Val Loss: 2.9548087667246334, Execution Accuracy = 0.0, Exact Match Accuracy = 0.0



|===================================== Epoch: 4 =====================================|
