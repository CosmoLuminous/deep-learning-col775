2023-03-20 17:46:11.819652: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/usr/local/cuda-11.0/lib64:/usr/local/cuda-11.0/lib64
2023-03-20 17:46:11.821829: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/usr/local/cuda-11.0/lib64:/usr/local/cuda-11.0/lib64
2023-03-20 17:46:11.821874: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1835] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
Namespace(batch_size=32, checkpoint_dir='checkpoints/seq2seq', data_dir='data', de_hidden=512, de_num_layers=1, device=device(type='cpu'), embed_dim=300, en_hidden=512, en_num_layers=1, epochs=200, model_type='Seq2Seq', num_workers=8, processed_data='processed_data', restore=False, result_dir='results/seq2seq')
cuda
Loading GloVe embeddings...
Loading Encoder...
Loading Seq2Seq LSTM Decoder...
Dataset Length = 7754
Encoder Vocab Size = 2040, Decoder Vocab Size = 2342
Dataset Length = 1939
Encoder Vocab Size = 2040, Decoder Vocab Size = 2342



|===================================== Epoch: 0 =====================================|
/mnt/home/siy197580/projects/deep-learning/a1/text2sql/text2sql.py:54: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  embedding_matrix[v] = torch.tensor(glove.vectors[glove.stoi[k]])
/usr/local/lib/python3.7/dist-packages/torch/nn/modules/rnn.py:61: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.3 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Epoch: 0, Total Time Elapsed: 0.4Mins, Train Loss: 0.002009131954508158, Prev Min Train Loss: 10000
Evaluating model on val data.
                     easy                 medium               hard                 extra                all                 
count                345                  549                  333                  309                  1536                
=====================   EXECUTION ACCURACY     =====================
execution            0.000                0.000                0.000                0.000                0.000               

====================== EXACT MATCHING ACCURACY =====================
exact match          0.000                0.000                0.000                0.000                0.000               

---------------------PARTIAL MATCHING ACCURACY----------------------
select               0.000                0.000                0.000                0.000                0.000               
select(no AGG)       0.000                0.000                0.000                0.000                0.000               
where                0.000                0.000                0.000                0.000                0.000               
where(no OP)         0.000                0.000                0.000                0.000                0.000               
group(no Having)     0.000                0.000                0.000                0.000                0.000               
group                0.000                0.000                0.000                0.000                0.000               
order                0.000                0.000                0.000                0.000                0.000               
and/or               1.000                0.831                0.856                0.718                0.852               
IUEN                 0.000                0.000                0.000                0.000                0.000               
keywords             0.000                0.000                0.000                0.000                0.000               
---------------------- PARTIAL MATCHING RECALL ----------------------
select               0.000                0.000                0.000                0.000                0.000               
select(no AGG)       0.000                0.000                0.000                0.000                0.000               
where                0.000                0.000                0.000                0.000                0.000               
where(no OP)         0.000                0.000                0.000                0.000                0.000               
group(no Having)     0.000                0.000                0.000                0.000                0.000               
group                0.000                0.000                0.000                0.000                0.000               
order                0.000                0.000                0.000                0.000                0.000               
and/or               1.000                1.000                1.000                1.000                1.000               
IUEN                 0.000                0.000                0.000                0.000                0.000               
keywords             0.000                0.000                0.000                0.000                0.000               
---------------------- PARTIAL MATCHING F1 --------------------------
select               1.000                1.000                1.000                1.000                1.000               
select(no AGG)       1.000                1.000                1.000                1.000                1.000               
where                1.000                1.000                1.000                1.000                1.000               
where(no OP)         1.000                1.000                1.000                1.000                1.000               
group(no Having)     1.000                1.000                1.000                1.000                1.000               
group                1.000                1.000                1.000                1.000                1.000               
order                1.000                1.000                1.000                1.000                1.000               
and/or               1.000                0.907                0.922                0.836                0.920               
IUEN                 1.000                1.000                1.000                1.000                1.000               
keywords             1.000                1.000                1.000                1.000                1.000               



|===================================== Epoch: 1 =====================================|
Epoch: 1, Total Time Elapsed: 1.5Mins, Train Loss: 0.001865296874395958, Prev Min Train Loss: 0.002009131954508158



|===================================== Epoch: 2 =====================================|
Epoch: 2, Total Time Elapsed: 1.92Mins, Train Loss: 0.0016672927131947918, Prev Min Train Loss: 0.001865296874395958



|===================================== Epoch: 3 =====================================|
Epoch: 3, Total Time Elapsed: 2.34Mins, Train Loss: 0.0014915416569414824, Prev Min Train Loss: 0.0016672927131947918



|===================================== Epoch: 4 =====================================|
Epoch: 4, Total Time Elapsed: 2.74Mins, Train Loss: 0.0013389107373112537, Prev Min Train Loss: 0.0014915416569414824



|===================================== Epoch: 5 =====================================|
Epoch: 5, Total Time Elapsed: 3.14Mins, Train Loss: 0.0012705192980759028, Prev Min Train Loss: 0.0013389107373112537



|===================================== Epoch: 6 =====================================|
Epoch: 6, Total Time Elapsed: 3.55Mins, Train Loss: 0.0011578119672091896, Prev Min Train Loss: 0.0012705192980759028



|===================================== Epoch: 7 =====================================|
Epoch: 7, Total Time Elapsed: 3.94Mins, Train Loss: 0.0010846419091461305, Prev Min Train Loss: 0.0011578119672091896



|===================================== Epoch: 8 =====================================|
Epoch: 8, Total Time Elapsed: 4.34Mins, Train Loss: 0.0010347854998197768, Prev Min Train Loss: 0.0010846419091461305



|===================================== Epoch: 9 =====================================|
Epoch: 9, Total Time Elapsed: 4.75Mins, Train Loss: 0.0009966306970524022, Prev Min Train Loss: 0.0010347854998197768



|===================================== Epoch: 10 =====================================|
Epoch: 10, Total Time Elapsed: 5.16Mins, Train Loss: 0.0009155650401509617, Prev Min Train Loss: 0.0009966306970524022
Evaluating model on val data.
                     easy                 medium               hard                 extra                all                 
count                345                  549                  333                  309                  1536                
=====================   EXECUTION ACCURACY     =====================
execution            0.000                0.000                0.003                0.000                0.001               

====================== EXACT MATCHING ACCURACY =====================
exact match          0.000                0.000                0.000                0.000                0.000               

---------------------PARTIAL MATCHING ACCURACY----------------------
select               0.000                0.000                1.000                0.000                0.286               
select(no AGG)       0.000                0.000                1.000                0.000                0.286               
where                0.500                0.000                0.000                0.000                0.200               
where(no OP)         0.500                0.000                0.000                0.000                0.200               
group(no Having)     0.000                0.000                0.000                0.000                0.000               
group                0.000                0.000                0.000                0.000                0.000               
order                0.000                0.000                0.000                0.000                0.000               
and/or               1.000                0.831                0.856                0.718                0.852               
IUEN                 0.000                0.000                0.000                0.000                0.000               
keywords             0.333                0.000                1.000                1.000                0.667               
---------------------- PARTIAL MATCHING RECALL ----------------------
select               0.000                0.000                0.006                0.000                0.001               
select(no AGG)       0.000                0.000                0.006                0.000                0.001               
where                0.007                0.000                0.000                0.000                0.001               
where(no OP)         0.007                0.000                0.000                0.000                0.001               
group(no Having)     0.000                0.000                0.000                0.000                0.000               
group                0.000                0.000                0.000                0.000                0.000               
order                0.000                0.000                0.000                0.000                0.000               
and/or               1.000                1.000                1.000                1.000                1.000               
IUEN                 0.000                0.000                0.000                0.000                0.000               
keywords             0.005                0.000                0.006                0.003                0.003               
---------------------- PARTIAL MATCHING F1 --------------------------
select               1.000                1.000                0.012                1.000                0.003               
select(no AGG)       1.000                1.000                0.012                1.000                0.003               
where                0.013                1.000                1.000                1.000                0.002               
where(no OP)         0.013                1.000                1.000                1.000                0.002               
group(no Having)     1.000                1.000                1.000                1.000                1.000               
group                1.000                1.000                1.000                1.000                1.000               
order                1.000                1.000                1.000                1.000                1.000               
and/or               1.000                0.907                0.922                0.836                0.920               
IUEN                 1.000                1.000                1.000                1.000                1.000               
keywords             0.010                1.000                0.012                0.006                0.006               



|===================================== Epoch: 11 =====================================|
Epoch: 11, Total Time Elapsed: 6.42Mins, Train Loss: 0.0008719939828156451, Prev Min Train Loss: 0.0009155650401509617



|===================================== Epoch: 12 =====================================|
Epoch: 12, Total Time Elapsed: 6.85Mins, Train Loss: 0.0008366960709903442, Prev Min Train Loss: 0.0008719939828156451



|===================================== Epoch: 13 =====================================|
